var bus=new Vue,contentTreeApp=new Vue({el:"#content-tree",data:{providers:[],message:"Hello Content Tree from VueJs"},mounted:function(){this.loadProviders()},methods:{loadProviders:function(){console.log("loading providers");var o=this;$.ajax({url:$("#GetTreeNodeProvidersUrl").val(),method:"GET",success:function(e){console.log("data is "+e),o.providers=e},error:function(e){console.log("error getting providers")}})}}});Vue.component("treeNode",{template:'        <li :class="{selected: isSelected}" >            <div :class="{treeroot: level == 1}">                <a href="javascript:;" :style="{ paddingLeft: padding + \'px\' }" v-on:click="select"  draggable="false" >                  <span v-on:click.stop="toggle" class="expand" :class="{opened: open, closed: !open, empty: empty}"><i class="fas fa-chevron-right"></i></span>                    {{model.title}}                </a>            </div>            <ol v-show="open">                <tree-node v-for="folder in children"                        :key="folder.path"                        :model="folder"                         :selected-in-media-app="selectedInMediaApp"                         :level="level + 1">                </tree-node>            </ol>        </li>        ',name:"treeNode",props:{model:Object,selectedInMediaApp:Object,level:Number},data:function(){return{open:!1,children:null,parent:null,isHovered:!1,padding:0}},computed:{empty:function(){return!this.children||0==this.children.length},isSelected:function(){return!1}},mounted:function(){this.padding=this.level<3?26:26+8*this.level},created:function(){},methods:{toggle:function(){console.log("toggling"),this.open=!this.open,this.open&&!this.children&&this.loadChildren()},select:function(){console.log("selecting: first loadchildren, then call Url if not null");var e=this;bus.$emit("folderSelected",this.model),this.loadChildren(),e.model.url?(console.log("calling this urlfff"),console.log(e.model.url),$.ajax({url:e.model.url,method:"GET",success:function(e){console.log("children are:"),console.log(e)},error:function(e){emtpy=!1,console.error(e.responseText)}})):console.log("no url on this treenode, no call for content items")},loadChildren:function(){var o=this;0==this.open&&(this.open=!0),$.ajax({url:$("#GetChildrenUrl").val()+"?parentId="+encodeURIComponent(o.model.id)+"&parentType="+encodeURIComponent(o.model.type),method:"GET",success:function(e){console.log("children are:"),console.log(e),o.children=e},error:function(e){emtpy=!1,console.error(e.responseText)}})}}});
